<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç…§ç‰‡é€æ˜åº¦ä¿®å¤æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        .test-section {
            margin: 30px 0;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }
        .hero-photo {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            border: 4px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            object-fit: cover;
            transition: all 0.3s ease;
        }
        .hero-photo:hover {
            transform: scale(1.05);
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.4);
        }
        .status {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
            background: rgba(0, 0, 0, 0.3);
        }
        .success { color: #4CAF50; }
        .error { color: #f44336; }
        .info { color: #2196F3; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ” ç…§ç‰‡é€æ˜åº¦ä¿®å¤æµ‹è¯•</h1>
        <p>è¿™ä¸ªé¡µé¢ç”¨äºéªŒè¯ä¸ªäººç…§ç‰‡é€æ˜åº¦ä¿®å¤æ˜¯å¦æˆåŠŸ</p>
        
        <div class="test-section">
            <h2>ğŸ“¸ ä¸ªäººç…§ç‰‡æµ‹è¯•</h2>
            <img src="assets/profile-photo.jpg" alt="ä¸ªäººç…§ç‰‡" class="hero-photo" id="test-photo">
            <div id="photo-status" class="status"></div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ“Š æµ‹è¯•ç»“æœ</h2>
            <div id="test-results"></div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ› ï¸ è°ƒè¯•ä¿¡æ¯</h2>
            <div id="debug-info"></div>
        </div>
    </div>

    <script src="js/image-fallback.js"></script>
    <script>
        // ç­‰å¾…é¡µé¢åŠ è½½å®Œæˆ
        window.addEventListener('load', function() {
            setTimeout(runTests, 500); // ç¨å¾®å»¶è¿Ÿä»¥ç¡®ä¿æ‰€æœ‰è„šæœ¬æ‰§è¡Œå®Œæ¯•
        });
        
        function runTests() {
            const photo = document.getElementById('test-photo');
            const statusDiv = document.getElementById('photo-status');
            const resultsDiv = document.getElementById('test-results');
            const debugDiv = document.getElementById('debug-info');
            
            let testsPassed = 0;
            let totalTests = 0;
            
            // æµ‹è¯•1: æ£€æŸ¥å›¾ç‰‡æ˜¯å¦å¯è§
            totalTests++;
            const isVisible = window.getComputedStyle(photo).opacity !== '0';
            if (isVisible) {
                testsPassed++;
                statusDiv.innerHTML = '<span class="success">âœ… ç…§ç‰‡å¯è§ - é€æ˜åº¦ä¿®å¤æˆåŠŸï¼</span>';
            } else {
                statusDiv.innerHTML = '<span class="error">âŒ ç…§ç‰‡ä¸å¯è§ - é€æ˜åº¦ä»ä¸º0</span>';
            }
            
            // æµ‹è¯•2: æ£€æŸ¥å›¾ç‰‡åŠ è½½çŠ¶æ€
            totalTests++;
            let loadStatus = '';
            if (photo.complete) {
                if (photo.naturalWidth > 0) {
                    testsPassed++;
                    loadStatus = '<span class="success">âœ… å›¾ç‰‡åŠ è½½æˆåŠŸ</span>';
                } else {
                    loadStatus = '<span class="error">âŒ å›¾ç‰‡åŠ è½½å¤±è´¥ï¼ˆnaturalWidthä¸º0ï¼‰</span>';
                }
            } else {
                loadStatus = '<span class="info">â³ å›¾ç‰‡æ­£åœ¨åŠ è½½ä¸­...</span>';
            }
            
            // æµ‹è¯•3: æ£€æŸ¥é€æ˜åº¦å€¼
            totalTests++;
            const opacity = window.getComputedStyle(photo).opacity;
            let opacityStatus = '';
            if (opacity === '1') {
                testsPassed++;
                opacityStatus = '<span class="success">âœ… é€æ˜åº¦ä¸º1ï¼ˆå®Œå…¨å¯è§ï¼‰</span>';
            } else if (opacity === '0') {
                opacityStatus = '<span class="error">âŒ é€æ˜åº¦ä¸º0ï¼ˆå®Œå…¨ä¸å¯è§ï¼‰</span>';
            } else {
                opacityStatus = `<span class="info">â„¹ï¸ é€æ˜åº¦ä¸º${opacity}ï¼ˆéƒ¨åˆ†å¯è§ï¼‰</span>`;
            }
            
            // æ˜¾ç¤ºæµ‹è¯•ç»“æœ
            resultsDiv.innerHTML = `
                <div class="status">${loadStatus}</div>
                <div class="status">${opacityStatus}</div>
                <div class="status"><strong>æµ‹è¯•é€šè¿‡ç‡: ${testsPassed}/${totalTests}</strong></div>
            `;
            
            // æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯
            debugDiv.innerHTML = `
                <div class="status info">
                    <strong>è°ƒè¯•ä¿¡æ¯:</strong><br>
                    å›¾ç‰‡å®ŒæˆçŠ¶æ€: ${photo.complete}<br>
                    è‡ªç„¶å®½åº¦: ${photo.naturalWidth}px<br>
                    è®¡ç®—é€æ˜åº¦: ${opacity}<br>
                    å›¾ç‰‡æº: ${photo.src}<br>
                    å›¾ç‰‡ç±»å: ${photo.className}
                </div>
            `;
            
            // å¦‚æœæµ‹è¯•å¤±è´¥ï¼Œæä¾›é¢å¤–çš„è°ƒè¯•ä¿¡æ¯
            if (testsPassed < totalTests) {
                debugDiv.innerHTML += `
                    <div class="status error">
                        <strong>ä¿®å¤å»ºè®®:</strong><br>
                        1. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰JavaScripté”™è¯¯<br>
                        2. ç¡®è®¤image-fallback.jsæ–‡ä»¶å·²æ­£ç¡®åŠ è½½<br>
                        3. æ£€æŸ¥æ˜¯å¦æœ‰å…¶ä»–CSSæˆ–JavaScriptè¦†ç›–äº†é€æ˜åº¦è®¾ç½®<br>
                        4. å°è¯•æ¸…é™¤æµè§ˆå™¨ç¼“å­˜ååˆ·æ–°é¡µé¢
                    </div>
                `;
            }
        }
        
        // æ·»åŠ æ§åˆ¶å°æ—¥å¿—ä»¥ä¾¿è¿›ä¸€æ­¥è°ƒè¯•
        console.log('ç…§ç‰‡é€æ˜åº¦ä¿®å¤æµ‹è¯•å¼€å§‹...');
        console.log('å½“å‰é¡µé¢URL:', window.location.href);
        console.log('image-fallback.js å·²åŠ è½½:', typeof window.imageFallback !== 'undefined');
    </script>
</body>
</html>