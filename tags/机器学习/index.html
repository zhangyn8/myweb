<!doctype html><html lang=zh-cn><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>æœºå™¨å­¦ä¹  - æˆ‘çš„ä¸ªäººç½‘ç«™</title>
<meta name=description content="Chrystalçš„ä¸ªäººç½‘ç«™ - AIè®­ç»ƒå¸ˆ & å¼€å‘è€…"><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel=stylesheet><link rel=stylesheet href=/css/main.css><link rel=stylesheet href=/css/cali-style.css><link rel=stylesheet href=/css/custom.css><link rel=icon type=image/x-icon href=/favicon.ico><meta name=theme-color content="#667eea"><meta property="og:type" content="website"><meta property="og:url" content="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"><meta property="og:title" content="æœºå™¨å­¦ä¹ "><meta property="og:description" content="Chrystalçš„ä¸ªäººç½‘ç«™ - AIè®­ç»ƒå¸ˆ & å¼€å‘è€…"><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"><meta property="twitter:title" content="æœºå™¨å­¦ä¹ "><meta property="twitter:description" content="Chrystalçš„ä¸ªäººç½‘ç«™ - AIè®­ç»ƒå¸ˆ & å¼€å‘è€…"><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebSite","name":"æˆ‘çš„ä¸ªäººç½‘ç«™","description":"Chrystalçš„ä¸ªäººç½‘ç«™ - AIè®­ç»ƒå¸ˆ \u0026 å¼€å‘è€…","url":"\/","author":{"@type":"Person","name":"Chrystal"}}</script></head><body><div class=main-container><main class=main-content><div class=list-page><header class=page-header><h1 class=page-title>æœºå™¨å­¦ä¹ </h1></header><div class=post-list><article class=post-card><div class=post-meta><time datetime=2024-01-20>January 20, 2024</time></div><h2 class=post-title><a href=/posts/ai-large-language-models/>AIå¤§è¯­è¨€æ¨¡å‹å…¥é—¨æŒ‡å—</a></h2><p class=post-summary><h1 id=aiå¤§è¯­è¨€æ¨¡å‹å…¥é—¨æŒ‡å—>AIå¤§è¯­è¨€æ¨¡å‹å…¥é—¨æŒ‡å—</h1><p>å¤§è¯­è¨€æ¨¡å‹ï¼ˆLarge Language Models, LLMsï¼‰æ˜¯äººå·¥æ™ºèƒ½é¢†åŸŸæœ€ä»¤äººå…´å¥‹çš„å‘å±•ä¹‹ä¸€ã€‚ä»ChatGPTåˆ°Claudeï¼Œè¿™äº›æ¨¡å‹æ­£åœ¨æ”¹å˜æˆ‘ä»¬ä¸è®¡ç®—æœºäº¤äº’çš„æ–¹å¼ã€‚</p><h2 id=ä»€ä¹ˆæ˜¯å¤§è¯­è¨€æ¨¡å‹>ä»€ä¹ˆæ˜¯å¤§è¯­è¨€æ¨¡å‹ï¼Ÿ</h2><p>å¤§è¯­è¨€æ¨¡å‹æ˜¯åŸºäºæ·±åº¦å­¦ä¹ çš„AIç³»ç»Ÿï¼Œé€šè¿‡è®­ç»ƒå¤§é‡æ–‡æœ¬æ•°æ®æ¥ç†è§£å’Œç”Ÿæˆäººç±»è¯­è¨€ã€‚å®ƒä»¬èƒ½å¤Ÿï¼š</p><ul><li>ğŸ“ <strong>æ–‡æœ¬ç”Ÿæˆ</strong>: åˆ›ä½œæ–‡ç« ã€æ•…äº‹ã€ä»£ç </li><li>ğŸ’¬ <strong>å¯¹è¯äº¤äº’</strong>: è¿›è¡Œè‡ªç„¶è¯­è¨€å¯¹è¯</li><li>ğŸ” <strong>ä¿¡æ¯æå–</strong>: ä»æ–‡æœ¬ä¸­æå–å…³é”®ä¿¡æ¯</li><li>ğŸŒ <strong>ç¿»è¯‘</strong>: åœ¨ä¸åŒè¯­è¨€ä¹‹é—´ç¿»è¯‘</li><li>ğŸ§  <strong>æ¨ç†</strong>: è¿›è¡Œé€»è¾‘æ¨ç†å’Œåˆ†æ</li></ul><h2 id=æ ¸å¿ƒæŠ€æœ¯åŸç†>æ ¸å¿ƒæŠ€æœ¯åŸç†</h2><h3 id=transformeræ¶æ„>Transformeræ¶æ„</h3><p>å¤§è¯­è¨€æ¨¡å‹çš„æ ¸å¿ƒæ˜¯Transformeræ¶æ„ï¼Œå®ƒå¼•å…¥äº†<strong>æ³¨æ„åŠ›æœºåˆ¶</strong>ï¼ˆAttention Mechanismï¼‰ï¼š</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#57606a># ç®€åŒ–çš„æ³¨æ„åŠ›æœºåˆ¶æ¦‚å¿µ</span>
</span></span><span style=display:flex><span><span style=color:#cf222e>class</span> <span style=color:#1f2328>Attention</span><span style=color:#1f2328>:</span>
</span></span><span style=display:flex><span>    <span style=color:#cf222e>def</span> <span style=color:#6639ba>__init__</span><span style=color:#1f2328>(</span><span style=color:#6a737d>self</span><span style=color:#1f2328>,</span> dim<span style=color:#1f2328>):</span>
</span></span><span style=display:flex><span>        <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>query <span style=color:#0550ae>=</span> nn<span style=color:#0550ae>.</span>Linear<span style=color:#1f2328>(</span>dim<span style=color:#1f2328>,</span> dim<span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>        <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>key <span style=color:#0550ae>=</span> nn<span style=color:#0550ae>.</span>Linear<span style=color:#1f2328>(</span>dim<span style=color:#1f2328>,</span> dim<span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>        <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>value <span style=color:#0550ae>=</span> nn<span style=color:#0550ae>.</span>Linear<span style=color:#1f2328>(</span>dim<span style=color:#1f2328>,</span> dim<span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#cf222e>def</span> <span style=color:#6639ba>forward</span><span style=color:#1f2328>(</span><span style=color:#6a737d>self</span><span style=color:#1f2328>,</span> x<span style=color:#1f2328>):</span>
</span></span><span style=display:flex><span>        Q <span style=color:#0550ae>=</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>query<span style=color:#1f2328>(</span>x<span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>        K <span style=color:#0550ae>=</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>key<span style=color:#1f2328>(</span>x<span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>        V <span style=color:#0550ae>=</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>value<span style=color:#1f2328>(</span>x<span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#57606a># è®¡ç®—æ³¨æ„åŠ›æƒé‡</span>
</span></span><span style=display:flex><span>        attention_weights <span style=color:#0550ae>=</span> torch<span style=color:#0550ae>.</span>softmax<span style=color:#1f2328>(</span>Q <span style=color:#0550ae>@</span> K<span style=color:#0550ae>.</span>T <span style=color:#0550ae>/</span> sqrt<span style=color:#1f2328>(</span>dim<span style=color:#1f2328>),</span> dim<span style=color:#0550ae>=-</span><span style=color:#0550ae>1</span><span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>        <span style=color:#cf222e>return</span> attention_weights <span style=color:#0550ae>@</span> V
</span></span></code></pre></td></tr></table></div></div><h3 id=é¢„è®­ç»ƒè¿‡ç¨‹>é¢„è®­ç»ƒè¿‡ç¨‹</h3><ol><li><strong>æ•°æ®æ”¶é›†</strong>: æ”¶é›†æµ·é‡æ–‡æœ¬æ•°æ®</li><li><strong>åˆ†è¯å¤„ç†</strong>: å°†æ–‡æœ¬è½¬æ¢ä¸ºtoken</li><li><strong>æ¨¡å‹è®­ç»ƒ</strong>: é¢„æµ‹ä¸‹ä¸€ä¸ªtoken</li><li><strong>å‚æ•°è°ƒä¼˜</strong>: ä¼˜åŒ–æ¨¡å‹æ€§èƒ½</li></ol><h2 id=è®­ç»ƒå¤§è¯­è¨€æ¨¡å‹çš„æ­¥éª¤>è®­ç»ƒå¤§è¯­è¨€æ¨¡å‹çš„æ­¥éª¤</h2><h3 id=1-æ•°æ®å‡†å¤‡>1. æ•°æ®å‡†å¤‡</h3><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#57606a># æ•°æ®é¢„å¤„ç†ç¤ºä¾‹</span>
</span></span><span style=display:flex><span><span style=color:#cf222e>def</span> <span style=color:#6639ba>preprocess_text</span><span style=color:#1f2328>(</span>text<span style=color:#1f2328>):</span>
</span></span><span style=display:flex><span>    <span style=color:#57606a># æ¸…ç†æ–‡æœ¬</span>
</span></span><span style=display:flex><span>    text <span style=color:#0550ae>=</span> clean_text<span style=color:#1f2328>(</span>text<span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>    <span style=color:#57606a># åˆ†è¯</span>
</span></span><span style=display:flex><span>    tokens <span style=color:#0550ae>=</span> tokenizer<span style=color:#0550ae>.</span>tokenize<span style=color:#1f2328>(</span>text<span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>    <span style=color:#57606a># åˆ›å»ºè®­ç»ƒæ ·æœ¬</span>
</span></span><span style=display:flex><span>    <span style=color:#cf222e>return</span> create_training_examples<span style=color:#1f2328>(</span>tokens<span style=color:#1f2328>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=2-æ¨¡å‹æ¶æ„è®¾è®¡>2. æ¨¡å‹æ¶æ„è®¾è®¡</h3><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#57606a># ç®€åŒ–çš„GPTæ¶æ„</span>
</span></span><span style=display:flex><span><span style=color:#cf222e>class</span> <span style=color:#1f2328>GPTModel</span><span style=color:#1f2328>(</span>nn<span style=color:#0550ae>.</span>Module<span style=color:#1f2328>):</span>
</span></span><span style=display:flex><span>    <span style=color:#cf222e>def</span> <span style=color:#6639ba>__init__</span><span style=color:#1f2328>(</span><span style=color:#6a737d>self</span><span style=color:#1f2328>,</span> vocab_size<span style=color:#1f2328>,</span> d_model<span style=color:#1f2328>,</span> n_heads<span style=color:#1f2328>,</span> n_layers<span style=color:#1f2328>):</span>
</span></span><span style=display:flex><span>        <span style=color:#6639ba>super</span><span style=color:#1f2328>()</span><span style=color:#0550ae>.</span><span style=color:#6639ba>__init__</span><span style=color:#1f2328>()</span>
</span></span><span style=display:flex><span>        <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>embedding <span style=color:#0550ae>=</span> nn<span style=color:#0550ae>.</span>Embedding<span style=color:#1f2328>(</span>vocab_size<span style=color:#1f2328>,</span> d_model<span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>        <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>transformer_blocks <span style=color:#0550ae>=</span> nn<span style=color:#0550ae>.</span>ModuleList<span style=color:#1f2328>([</span>
</span></span><span style=display:flex><span>            TransformerBlock<span style=color:#1f2328>(</span>d_model<span style=color:#1f2328>,</span> n_heads<span style=color:#1f2328>)</span> 
</span></span><span style=display:flex><span>            <span style=color:#cf222e>for</span> _ <span style=color:#0550ae>in</span> <span style=color:#6639ba>range</span><span style=color:#1f2328>(</span>n_layers<span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>        <span style=color:#1f2328>])</span>
</span></span><span style=display:flex><span>        <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>ln_f <span style=color:#0550ae>=</span> nn<span style=color:#0550ae>.</span>LayerNorm<span style=color:#1f2328>(</span>d_model<span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>        <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>head <span style=color:#0550ae>=</span> nn<span style=color:#0550ae>.</span>Linear<span style=color:#1f2328>(</span>d_model<span style=color:#1f2328>,</span> vocab_size<span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#cf222e>def</span> <span style=color:#6639ba>forward</span><span style=color:#1f2328>(</span><span style=color:#6a737d>self</span><span style=color:#1f2328>,</span> input_ids<span style=color:#1f2328>):</span>
</span></span><span style=display:flex><span>        x <span style=color:#0550ae>=</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>embedding<span style=color:#1f2328>(</span>input_ids<span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>        <span style=color:#cf222e>for</span> block <span style=color:#0550ae>in</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>transformer_blocks<span style=color:#1f2328>:</span>
</span></span><span style=display:flex><span>            x <span style=color:#0550ae>=</span> block<span style=color:#1f2328>(</span>x<span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>        x <span style=color:#0550ae>=</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>ln_f<span style=color:#1f2328>(</span>x<span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>        <span style=color:#cf222e>return</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>head<span style=color:#1f2328>(</span>x<span style=color:#1f2328>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=3-è®­ç»ƒå¾ªç¯>3. è®­ç»ƒå¾ªç¯</h3><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#57606a># è®­ç»ƒå¾ªç¯</span>
</span></span><span style=display:flex><span><span style=color:#cf222e>def</span> <span style=color:#6639ba>train_model</span><span style=color:#1f2328>(</span>model<span style=color:#1f2328>,</span> dataloader<span style=color:#1f2328>,</span> optimizer<span style=color:#1f2328>,</span> criterion<span style=color:#1f2328>):</span>
</span></span><span style=display:flex><span>    model<span style=color:#0550ae>.</span>train<span style=color:#1f2328>()</span>
</span></span><span style=display:flex><span>    <span style=color:#cf222e>for</span> batch <span style=color:#0550ae>in</span> dataloader<span style=color:#1f2328>:</span>
</span></span><span style=display:flex><span>        inputs<span style=color:#1f2328>,</span> targets <span style=color:#0550ae>=</span> batch
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        optimizer<span style=color:#0550ae>.</span>zero_grad<span style=color:#1f2328>()</span>
</span></span><span style=display:flex><span>        outputs <span style=color:#0550ae>=</span> model<span style=color:#1f2328>(</span>inputs<span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>        loss <span style=color:#0550ae>=</span> criterion<span style=color:#1f2328>(</span>outputs<span style=color:#0550ae>.</span>view<span style=color:#1f2328>(</span><span style=color:#0550ae>-</span><span style=color:#0550ae>1</span><span style=color:#1f2328>,</span> vocab_size<span style=color:#1f2328>),</span> targets<span style=color:#0550ae>.</span>view<span style=color:#1f2328>(</span><span style=color:#0550ae>-</span><span style=color:#0550ae>1</span><span style=color:#1f2328>))</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        loss<span style=color:#0550ae>.</span>backward<span style=color:#1f2328>()</span>
</span></span><span style=display:flex><span>        optimizer<span style=color:#0550ae>.</span>step<span style=color:#1f2328>()</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#6639ba>print</span><span style=color:#1f2328>(</span><span style=color:#0a3069>f</span><span style=color:#0a3069>&#34;Loss: </span><span style=color:#0a3069>{</span>loss<span style=color:#0550ae>.</span>item<span style=color:#1f2328>()</span><span style=color:#0a3069>:</span><span style=color:#0a3069>.4f</span><span style=color:#0a3069>}</span><span style=color:#0a3069>&#34;</span><span style=color:#1f2328>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=å®é™…åº”ç”¨åœºæ™¯>å®é™…åº”ç”¨åœºæ™¯</h2><h3 id=å†…å®¹åˆ›ä½œ>å†…å®¹åˆ›ä½œ</h3><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#57606a># ä½¿ç”¨å¤§è¯­è¨€æ¨¡å‹ç”Ÿæˆå†…å®¹</span>
</span></span><span style=display:flex><span><span style=color:#cf222e>from</span> <span style=color:#24292e>transformers</span> <span style=color:#cf222e>import</span> pipeline
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>generator <span style=color:#0550ae>=</span> pipeline<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;text-generation&#34;</span><span style=color:#1f2328>,</span> model<span style=color:#0550ae>=</span><span style=color:#0a3069>&#34;gpt2&#34;</span><span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>prompt <span style=color:#0550ae>=</span> <span style=color:#0a3069>&#34;äººå·¥æ™ºèƒ½çš„æœªæ¥å‘å±•&#34;</span>
</span></span><span style=display:flex><span>generated_text <span style=color:#0550ae>=</span> generator<span style=color:#1f2328>(</span>prompt<span style=color:#1f2328>,</span> max_length<span style=color:#0550ae>=</span><span style=color:#0550ae>200</span><span style=color:#1f2328>,</span> num_return_sequences<span style=color:#0550ae>=</span><span style=color:#0550ae>1</span><span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span><span style=color:#6639ba>print</span><span style=color:#1f2328>(</span>generated_text<span style=color:#1f2328>[</span><span style=color:#0550ae>0</span><span style=color:#1f2328>][</span><span style=color:#0a3069>&#39;generated_text&#39;</span><span style=color:#1f2328>])</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ™ºèƒ½å®¢æœ>æ™ºèƒ½å®¢æœ</h3><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#57606a># æ„å»ºå¯¹è¯ç³»ç»Ÿ</span>
</span></span><span style=display:flex><span><span style=color:#cf222e>class</span> <span style=color:#1f2328>ChatBot</span><span style=color:#1f2328>:</span>
</span></span><span style=display:flex><span>    <span style=color:#cf222e>def</span> <span style=color:#6639ba>__init__</span><span style=color:#1f2328>(</span><span style=color:#6a737d>self</span><span style=color:#1f2328>,</span> model_name<span style=color:#1f2328>):</span>
</span></span><span style=display:flex><span>        <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>chatbot <span style=color:#0550ae>=</span> pipeline<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;conversational&#34;</span><span style=color:#1f2328>,</span> model<span style=color:#0550ae>=</span>model_name<span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#cf222e>def</span> <span style=color:#6639ba>respond</span><span style=color:#1f2328>(</span><span style=color:#6a737d>self</span><span style=color:#1f2328>,</span> user_input<span style=color:#1f2328>):</span>
</span></span><span style=display:flex><span>        response <span style=color:#0550ae>=</span> <span style=color:#6a737d>self</span><span style=color:#0550ae>.</span>chatbot<span style=color:#1f2328>(</span>user_input<span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>        <span style=color:#cf222e>return</span> response
</span></span></code></pre></td></tr></table></div></div><h3 id=ä»£ç ç”Ÿæˆ>ä»£ç ç”Ÿæˆ</h3><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#57606a># ä»£ç ç”Ÿæˆç¤ºä¾‹</span>
</span></span><span style=display:flex><span>code_generator <span style=color:#0550ae>=</span> pipeline<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;text-generation&#34;</span><span style=color:#1f2328>,</span> model<span style=color:#0550ae>=</span><span style=color:#0a3069>&#34;CodeT5&#34;</span><span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>prompt <span style=color:#0550ae>=</span> <span style=color:#0a3069>&#34;# ç”¨Pythonå®ç°å¿«é€Ÿæ’åºç®—æ³•&#34;</span>
</span></span><span style=display:flex><span>code <span style=color:#0550ae>=</span> code_generator<span style=color:#1f2328>(</span>prompt<span style=color:#1f2328>,</span> max_length<span style=color:#0550ae>=</span><span style=color:#0550ae>150</span><span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span><span style=color:#6639ba>print</span><span style=color:#1f2328>(</span>code<span style=color:#1f2328>[</span><span style=color:#0550ae>0</span><span style=color:#1f2328>][</span><span style=color:#0a3069>&#39;generated_text&#39;</span><span style=color:#1f2328>])</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=æŒ‘æˆ˜ä¸é™åˆ¶>æŒ‘æˆ˜ä¸é™åˆ¶</h2><h3 id=æŠ€æœ¯æŒ‘æˆ˜>æŠ€æœ¯æŒ‘æˆ˜</h3><ol><li><strong>è®¡ç®—èµ„æº</strong>: éœ€è¦å¤§é‡GPU/TPUèµ„æº</li><li><strong>æ•°æ®è´¨é‡</strong>: è®­ç»ƒæ•°æ®çš„è´¨é‡ç›´æ¥å½±å“æ¨¡å‹æ€§èƒ½</li><li><strong>æ¨¡å‹å¤§å°</strong>: æ¨¡å‹å‚æ•°é‡å·¨å¤§ï¼Œå­˜å‚¨å’Œéƒ¨ç½²å›°éš¾</li><li><strong>è®­ç»ƒæ—¶é—´</strong>: è®­ç»ƒå‘¨æœŸé•¿ï¼Œæˆæœ¬é«˜</li></ol><h3 id=ä¼¦ç†è€ƒé‡>ä¼¦ç†è€ƒé‡</h3><ol><li><strong>åè§é—®é¢˜</strong>: æ¨¡å‹å¯èƒ½å­¦ä¹ è®­ç»ƒæ•°æ®ä¸­çš„åè§</li><li><strong>è¯¯å¯¼ä¿¡æ¯</strong>: å¯èƒ½ç”Ÿæˆè™šå‡æˆ–ä¸å‡†ç¡®çš„ä¿¡æ¯</li><li><strong>éšç§é—®é¢˜</strong>: è®­ç»ƒæ•°æ®å¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯</li><li><strong>ç¯å¢ƒå½±å“</strong>: å¤§é‡è®¡ç®—èµ„æºæ¶ˆè€—èƒ½æº</li></ol><h2 id=æœªæ¥å‘å±•è¶‹åŠ¿>æœªæ¥å‘å±•è¶‹åŠ¿</h2><h3 id=æŠ€æœ¯å‘å±•æ–¹å‘>æŠ€æœ¯å‘å±•æ–¹å‘</h3><ul><li><strong>å¤šæ¨¡æ€èåˆ</strong>: ç»“åˆæ–‡æœ¬ã€å›¾åƒã€éŸ³é¢‘</li><li><strong>æ•ˆç‡ä¼˜åŒ–</strong>: æ¨¡å‹å‹ç¼©å’ŒåŠ é€ŸæŠ€æœ¯</li><li><strong>ä¸ªæ€§åŒ–</strong>: é’ˆå¯¹ç‰¹å®šç”¨æˆ·æˆ–é¢†åŸŸå®šåˆ¶</li><li><strong>å¯è§£é‡Šæ€§</strong>: æé«˜æ¨¡å‹å†³ç­–çš„é€æ˜åº¦</li></ul><h3 id=åº”ç”¨å‰æ™¯>åº”ç”¨å‰æ™¯</h3><ul><li>ğŸ¥ <strong>åŒ»ç–—å¥åº·</strong>: è¾…åŠ©è¯Šæ–­å’Œæ²»ç–—å»ºè®®</li><li>ğŸ“ <strong>æ•™è‚²åŸ¹è®­</strong>: ä¸ªæ€§åŒ–å­¦ä¹ å’Œæ•™å­¦è¾…åŠ©</li><li>ğŸ’¼ <strong>å•†ä¸šåº”ç”¨</strong>: å¸‚åœºåˆ†æå’Œå†³ç­–æ”¯æŒ</li><li>ğŸ”¬ <strong>ç§‘å­¦ç ”ç©¶</strong>: åŠ é€Ÿç§‘ç ”å‘ç°å’Œè®ºæ–‡å†™ä½œ</li></ul><h2 id=å­¦ä¹ èµ„æºæ¨è>å­¦ä¹ èµ„æºæ¨è</h2><h3 id=åœ¨çº¿è¯¾ç¨‹>åœ¨çº¿è¯¾ç¨‹</h3><ul><li><a href=https://www.deeplearning.ai/>DeepLearning.AI</a></li><li><a href=https://www.fast.ai/>Fast.ai</a></li><li><a href=https://www.coursera.org/learn/machine-learning>Courseraæœºå™¨å­¦ä¹ è¯¾ç¨‹</a></li></ul><h3 id=å¼€æºé¡¹ç›®>å¼€æºé¡¹ç›®</h3><ul><li><a href=https://github.com/huggingface/transformers>Hugging Face Transformers</a></li><li><a href=https://github.com/openai/gpt-3>OpenAI GPT</a></li><li><a href=https://github.com/google-research/bert>Google BERT</a></li></ul><h3 id=è®ºæ–‡æ¨è>è®ºæ–‡æ¨è</h3><ul><li>&ldquo;Attention Is All You Need&rdquo; - TransformeråŸå§‹è®ºæ–‡</li><li>&ldquo;Language Models are Few-Shot Learners&rdquo; - GPT-3è®ºæ–‡</li><li>&ldquo;BERT: Pre-training of Deep Bidirectional Transformers&rdquo; - BERTè®ºæ–‡</li></ul><h2 id=å®è·µå»ºè®®>å®è·µå»ºè®®</h2><ol><li><strong>ä»åŸºç¡€å¼€å§‹</strong>: å…ˆæŒæ¡æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ åŸºç¡€</li><li><strong>åŠ¨æ‰‹å®è·µ</strong>: ä½¿ç”¨Hugging Faceç­‰åº“è¿›è¡Œå®éªŒ</li><li><strong>å…³æ³¨å‰æ²¿</strong>: è·Ÿè¸ªæœ€æ–°ç ”ç©¶å’Œå‘å±•</li><li><strong>å‚ä¸ç¤¾åŒº</strong>: åŠ å…¥AIå’Œæœºå™¨å­¦ä¹ ç¤¾åŒº</li><li><strong>ä¼¦ç†æ€è€ƒ</strong>: è€ƒè™‘AIæŠ€æœ¯çš„ç¤¾ä¼šå½±å“</li></ol><hr><p>å¤§è¯­è¨€æ¨¡å‹ä»£è¡¨äº†äººå·¥æ™ºèƒ½çš„ä¸€ä¸ªé‡è¦é‡Œç¨‹ç¢‘ï¼Œå®ƒä»¬ä¸ä»…ä»…æ˜¯æŠ€æœ¯å·¥å…·ï¼Œæ›´æ˜¯äººç±»æ™ºæ…§çš„å»¶ä¼¸ã€‚éšç€æŠ€æœ¯çš„ä¸æ–­å‘å±•ï¼Œæˆ‘ä»¬å¯ä»¥æœŸå¾…æ›´å¤šä»¤äººå…´å¥‹çš„åº”ç”¨å’Œçªç ´ã€‚</p></p><div class=post-tags><span class=tag>AI</span>
<span class=tag>æœºå™¨å­¦ä¹ </span>
<span class=tag>æ·±åº¦å­¦ä¹ </span></div></article></div></div></main></div><script>document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();const t=document.querySelector(this.getAttribute("href"));t&&t.scrollIntoView({behavior:"smooth",block:"start"})})});const lazyImages=document.querySelectorAll(".lazy-image");if("IntersectionObserver"in window){const e=new IntersectionObserver((e,t)=>{e.forEach(e=>{if(e.isIntersecting){const n=e.target;n.classList.add("loaded"),t.unobserve(n)}})});lazyImages.forEach(t=>{e.observe(t)})}else lazyImages.forEach(e=>{e.classList.add("loaded")});document.querySelectorAll(".project-image").forEach(e=>{e.addEventListener("click",function(){const e=document.createElement("div");e.style.cssText=`
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0,0,0,0.9);
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    z-index: 1000;
                    cursor: pointer;
                `;const t=document.createElement("img");t.src=this.src,t.alt=this.alt,t.style.cssText=`
                    max-width: 90%;
                    max-height: 90%;
                    border-radius: 8px;
                    box-shadow: 0 8px 16px rgba(0,0,0,0.3);
                `,e.appendChild(t),document.body.appendChild(e),e.addEventListener("click",function(){document.body.removeChild(e)}),document.addEventListener("keydown",function(t){t.key==="Escape"&&e.parentNode&&document.body.removeChild(e)})})})</script></body></html>